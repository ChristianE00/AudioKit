(()=>{var e={626:e=>{async function t(e,t){let a=await chrome.storage.local.get("levels"),o=null;null==a.levels?o={[e]:t}:(o=a.levels,o[e]=t),await chrome.storage.local.set({levels:o})}async function a(e){let t=(await chrome.storage.local.get("levels")).levels;return null!=t&&null!=t[e]&&(console.log("tablevels: "+t),!0)}async function o(e){let t=(await chrome.storage.local.get("levels")).levels;return!await a(e)||t[e]<0?(console.log("!!Level not found for tabId: ",e),100):(console.log("!!Level found for tabId: ",e),100*t[e])}async function n(){await chrome.offscreen.hasDocument()?console.log("Offscreen document already exists"):(console.log("Creating offscreen document"),await chrome.offscreen.createDocument({url:"offscreen.html",reasons:["USER_MEDIA"],justification:"Adjust tab audio volume"}),console.log("Created offscreen document"))}async function r(){let[e]=await chrome.tabs.query({active:!0,currentWindow:!0});return e}e.exports={worker:function(e,t){return e+t},sum:function(e,t){return e+t},getTabLevel:o,containsTab:a,getCurrentTab:r},chrome.runtime.onStartup.addListener((function(){console.log("Browser opened CLEARING CACHE"),chrome.storage.local.clear()})),new Map,chrome.runtime.onMessage.addListener((async e=>{let s,l;switch(e.type){case"popup-loaded":let i=await r(),c=await o(i.id),u=await async function(){let[e]=await chrome.tabs.query({active:!0,lastFocusedWindow:!0}),t="No active tab found.",a="False",o=!1;return e?(console.log(` Title: ${e.title}`),t=e.title,e.audible&&(a="True"),o=e.mutedInfo.muted):console.log("No active tab found."),[t,a,o.toString()]}(),d=u[0],g=u[1];l=u[2],chrome.runtime.sendMessage({type:"popup-level",level:c,title:d,audible:g,muted:l});break;case"toggle-mute":console.log("[SERVICE-WORKER] Toggle mute message received"),l=await async function(){let[e]=await chrome.tabs.query({active:!0,lastFocusedWindow:!0}),t=!e.mutedInfo.muted;return await chrome.tabs.update(e.id,{muted:t}),t.toString()}(),chrome.runtime.sendMessage({type:"tab-muted",muted:l});break;case"adjust-level":s=await r(),await async function(e,o){await n();let r=e.toString(),s=o.toString();if(await a(r))console.log("[WORKER] tab found in activeStreams W/ tabId: ",e," volume: ",o),chrome.runtime.sendMessage({type:"adjust-level",target:"offscreen",tabId:e,level:o}),await t(r,s);else{console.log("[WORKER] tab not found in activeStreams W/ tabId: ",e," volume: ",o);const a=await chrome.tabCapture.getMediaStreamId({targetTabId:e});chrome.runtime.sendMessage({type:"start-recording",target:"offscreen",data:a,tabId:e,level:o}),await t(r,s)}console.log("BEFORE"),await getCurrentTabTitle(),console.log("AFTER")}(s.id,e.level);break;case"testSave":s=await r(),await testSave(s.id);break;case"testGet":s=await r(),await testGet(s.id);break;case"clear-storage":await chrome.storage.local.clear();break;case"lowshelf-worker":s=await r(),await async function(e){console.log("[SERVICE-WORKER] Lowshelf function called"),await n();let o=e.toString();if(await a(o))chrome.runtime.sendMessage({type:"lowshelf",target:"offscreen",tabId:e});else{console.log("[SERVICE-WORKER] tab not found in activeStreams W/ tabId: ",e);const a=await chrome.tabCapture.getMediaStreamId({targetTabId:e});chrome.runtime.sendMessage({type:"lowshelf-start",target:"offscreen",data:a,tabId:e}),await t(o,1)}}(s.id);break;case"highshelf-worker":s=await r(),await async function(e){console.log("[SERVICE-WORKER] Highshelf function called"),await n();let o=e.toString();if(await a(o))chrome.runtime.sendMessage({type:"highshelf",target:"offscreen",tabId:e});else{console.log("[SERVICE-WORKER] tab not found in activeStreams W/ tabId: ",e);const a=await chrome.tabCapture.getMediaStreamId({targetTabId:e});chrome.runtime.sendMessage({type:"highshelf-start",target:"offscreen",data:a,tabId:e}),await t(o,1)}}(s.id);break;case"default-worker":s=await r(),await async function(e){await a(e)&&(chrome.runtime.sendMessage({type:"default",target:"offscreen",tabId:e}),await t(e,1),chrome.runtime.sendMessage({type:"popup-level",level:100}))}(s.id)}}))}},t={};!function a(o){var n=t[o];if(void 0!==n)return n.exports;var r=t[o]={exports:{}};return e[o](r,r.exports,a),r.exports}(626)})();